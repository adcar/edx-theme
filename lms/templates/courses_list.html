<%page expression_filter="h"/>
<%namespace name='static' file='static_content.html'/>
<%! from django.utils.translation import ugettext as _ %>
<%
from xmodule.modulestore.django import modulestore
from course_modes.models import CourseMode
%>
% if settings.FEATURES.get('COURSES_ARE_BROWSABLE'):
    <section class="courses-container">
        <ul class="courses-list">
            ## limiting the course number by using HOMEPAGE_COURSE_MAX as the maximum number of courses
            <%
                visible_courses = []
                for course in courses:
                    mongo_course = modulestore().get_course(course.id, depth=0)
                    if getattr(mongo_course, 'index_visible'):
                        # add `vendor` attr to course:
                        course_vendor = mongo_course.course_vendor if hasattr(mongo_course, 'course_vendor')  else ''
                        course.vendor = course_vendor
                        # add `certified` bool attr to course:
                        mode_slugs = [mode.slug for mode in CourseMode.modes_for_course(course.id)]
                        certified = bool(set(mode_slugs) & {CourseMode.AUDIT, CourseMode.HONOR, CourseMode.VERIFIED})
                        course.certified = certified

                        visible_courses.append(course)

                    if len(visible_courses) == settings.HOMEPAGE_COURSE_MAX:
                        break
            %>
            % for course in visible_courses:
            <li class="courses-listing-item">
                <%include file="course.html" args="course=course" />
            </li>
            % endfor
        </ul>
    </section>

    <a class="all-elearnings" href="${marketing_link('COURSES')}">ALL E-LEARNINGS</a>

    ## in case there are courses that are not shown on the homepage, a 'View all Courses' link should appear
    % if settings.HOMEPAGE_COURSE_MAX and len(courses) > settings.HOMEPAGE_COURSE_MAX:
        <div class="courses-more">
            <a class="courses-more-cta" href="${marketing_link('COURSES')}"> ${_("View all Courses")} </a>
        </div>
    % endif
% endif
